"NOME LIBRO E TROVA DIPARTIMENTI IN CUI E' PRESENTE'"

//LEFT JOIN PER EMULARE IL MENO
SELECT  C.NOME_DIP, COUNT(C.NUMERO_COPIA)
FROM (SELECT * FROM(SELECT ISBN,NUMERO_COPIA, NOME_DIP
FROM COPIA) X
LEFT JOIN
 (
SELECT P.ISBN,P.NUMERO_COPIA
FROM PRESTITO P
)  T
	ON X.ISBN = T.ISBN AND X.NUMERO_COPIA=T.NUMERO_COPIA
	WHERE
	T.ISBN IS NULL AND T.NUMERO_COPIA IS NULL), LIBRO L
WHERE C.ISBN = L.ISBN AND L.TITOLO LIKE '$titolo'
GROUP BY  L.TITOLO, C.NOME_DIP;



studenti con più prestiti attivi


SELECT S.MATRICOLA,S.NOME,S.COGNOME,COUNT(P.MATRICOLA) AS NUMERO_PRESTITI
FROM PRESTITO P,STUDENTE S
WHERE P.MATRICOLA=S.MATRICOLA
GROUP BY MATRICOLA
ORDER BY NUMERO_PRESTITI DESC;

dipartimenti con più libri (comprese le copie)


SELECT D.NOME_DIP,COUNT(C.NOME_DIP) AS NUMERO_LIBRI
FROM  DIPARTIMENTO D,COPIA C
WHERE D.NOME_DIP=C.NOME_DIP
GROUP BY NOME_DIP
ORDER BY NUMERO_LIBRI DESC;

inserisco data trovo prestiti

SELECT P.ISBN,L.TITOLO,P.NUMERO_COPIA,MATRICOLA,P.DATA_USCITA
FROM  PRESTITO P,COPIA C,LIBRO L
WHERE P.ISBN=C.ISBN AND P.NUMERO_COPIA=C.NUMERO_COPIA AND C.ISBN=L.ISBN AND P.DATA_USCITA='%DATA';


prestiti in imminente scadenza

//qui dovrò calcolare la data di rientro e vedere se è vicina a oggi (controllo su php)

SELECT S.MATRICOLA,S.NOME,S.COGNOME,P.ISBN,L.TITOLO,P.NUMERO_COPIA,P.DATA_USCITA, P.N_PROROGHE
FROM  PRESTITO P,COPIA C,STUDENTE S,LIBRO L
WHERE P.ISBN=C.ISBN AND P.NUMERO_COPIA = C.NUMERO_COPIA AND P.MATRICOLA = S.MATRICOLA AND P.ISBN = L.ISBN;
