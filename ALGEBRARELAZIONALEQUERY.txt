//SECONDO ME SI POTREBBE USARE LA SINTASSI CON LA FRECCIA A DESTRA PER CORRETTEZZA DI SINTASSI
//AD ESEMPIO PER COM'E' SCRITTA L'ULTIMA QUERY è PERFETTA, LE ALTRE MENO SONO MENO CONVINCENTI...
//OLTRETUTTO BISOSGNA RIGUARDARE LE PROIEZIONI PERCHE MI SA CHE NE MANCANO


PRIMA QUERY:
  TMP <- π NOME_LINGUA, NUMERO_LIBRI (NOME_LINGUA γ COUNT(NOME_LINGUA)->NUMERO_LIBRI  (LIBRO))
  TMPORDERED <- τ NUMERO_LIBRI DESC (TMP)
  RES <- σ ROWNUM() > 0 and ROWNUM() ≤ 5 (TMPORDERED)


SECONDA QUERY:
  INTERNA:
  TMP <- AUTORE * (AUTORE.ID_AUT = SCRIVE.ID_AUT) SCRIVE
  RES <- π ID_AUT, NOME_A, COGNOME_A, LIBRI_SCRITTI (ID_AUT γ COUNT(ID_AUT)->LIBRI_SCRITTI (TMP))                 //LIBRI SCRITTI PER OGNI AUTORE
  MAX_VALUE <- γ MAX LIBRI_SCRITTI (RES)
  ESTERNA:
  RESFINALE <-  σ LIBRI_SCRITTI=MAX_VALUE (RES)


TERZA QUERY:
INTERNA:
  TMP <- EDITORE * (EDITORE.CODICE = LIBRO.COD_ED) LIBRO
  RES <- π NOME_ED, LIBRI_PUBBLICATI (COD_ED γ COUNT(COD_ED)->LIBRI_PUBBLICATI (TMP))
  MAX_VALUE <- γ MAX LIBRI_PUBBLICATI (RES)

ESTERNA:
  RESFINALE <-  σ LIBRI_PUBBLICATI=MAX_VALUE (RES)








QUERY AGGIUNTIVE

PRIMA QUERY AGGIUNTIVA(COPIE DISPONIBILI):

    ρ T ( π ISBN, NUMERO_COPIA (PRESTITO))
    ρ X ( π ISBN, NUMERO_COPIA, NOME_DIP (COPIA))

    ResIntermedio <- X ⟕ (X.ISBN = T.ISBN AND X.NUMERO_COPIA = T.NUMERO_COPIA) T
    ρ C (π X.ISBN, X.NUMERO_COPIA, X.NOME_DIP (σ T.ISBN = NULL and T.NUMERO_COPIA = NULL (ResIntermedio)))

    //$titolo è il titolo del libro desiderato
    TMP <- C *(C.ISBN = LIBRO.ISBN AND LIBRO.TITOLO = '$titolo') LIBRO

    RES <- π C.NOME_DIP, COPIE_DISPONIBILI (TITOLO, NOME_DIP γ COUNT(NUMERO_COPIA)->COPIE_DISPONIBILI (TMP))



SECONDA QUERY studenti con più prestiti attivi:

     TMP <- PRESTITO *(PRESTITO.MATRICOLA = STUDENTE.MATRICOLA) STUDENTE
     RES <- π MATRICOLA, NOME, COGNOME, NUMERO_PRESTITI (MATRICOLA γ COUNT(MATRICOLA)->NUMERO_PRESTITI (TMP))
     RESFINALE <- τ NUMERO_PRESTITI desc (RES)




TERZA QUERY dipartimenti con più libri (comprese le copie):
    TMP <- DIPARTIMENTO *(DIPARTIMENTO.NOME_DIP = COPIA.NOME_DIP) COPIA
    RES <- π NOME_DIP, NUMERO_LIBRI (NOME_DIP γ COUNT(NOME_DIP)->NUMERO_LIBRI (TMP))
    RESORDINATO <- τ NUMERO_LIBRI desc (RES)



QUARTA QUERY inserisco data trovo prestiti in quella DATA:
    TMP <- PRESTITO *(PRESTITO.ISBN = COPIA.ISBN AND PRESTITO.NUMERO_COPIA = COPIA.NUMERO_COPIA) COPIA
    TMP2 <- TMP *(TMP.ISBN = LIBRO.ISBN AND DATA_USCITA = date('%data')) LIBRO
    RES <- π ISBN, TITOLO, NUMERO_COPIA, MATRICOLA, DATA_USCITA (TMP2)


QUINTA QUERY prestiti in imminente scadenza:
    TMP <- PRESTITO *(PRESTITO.ISBN = COPIA.ISBN AND PRESTITO.NUMERO_COPIA = COPIA.NUMERO_COPIA) COPIA
    TMP2 <- TMP *(TMP.ISBN = LIBRO.ISBN) LIBRO
    TMP3 <- TMP2 *(TMP2.MATRICOLA = STUDENTE.MATRICOLA) STUDENTE
    RES <- π MATRICOLA, NOME, COGNOME, ISBN, TITOLO, NUMERO_COPIA, DATA_USCITA, N_PROROGHE (TMP3)
