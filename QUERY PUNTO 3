
"5 LINGUE PIU FREQUENTI"

SELECT E_SCRITTO.NOME_LINGUA,COUNT(E_SCRITTO.NOME_LINGUA) AS NUMERO_LIBRI
                            FROM E_SCRITTO
                            GROUP BY E_SCRITTO.NOME_LINGUA
                            ORDER BY NUMERO_LIBRI  DESC
                            LIMIT 5;

"AUTORE CHE HA SCRITTO PIU LIBRI"

SELECT A.ID_AUT,A.NOME_A,COGNOME_A,COUNT(S.ID_AUT) AS LIBRI_SCRITTI
FROM AUTORE A,SCRIVE S
WHERE A.ID_AUT=S.ID_AUT
GROUP BY A.ID_AUT
HAVING LIBRI_SCRITTI=(SELECT MAX(T.LIBRI_SCRITTI)
						FROM(SELECT A.ID_AUT,A.NOME_A,COGNOME_A,COUNT(S.ID_AUT) AS LIBRI_SCRITTI
								FROM AUTORE A,SCRIVE S
								WHERE A.ID_AUT=S.ID_AUT
								GROUP BY A.ID_AUT
								ORDER BY LIBRI_SCRITTI DESC) AS T)
ORDER BY LIBRI_SCRITTI DESC;


"EDITORE CHE HA PUBBLICATO PIU LIBRI"

SELECT E.NOME_ED,COUNT(L.COD_ED) AS LIBRI_PUBBLICATI
FROM EDITORE E,LIBRO L
WHERE E.CODICE=L.COD_ED
GROUP BY L.COD_ED
HAVING LIBRI_PUBBLICATI=(SELECT MAX(T.LIBRI_PUBBLICATI)
							FROM(SELECT E.NOME_ED,COUNT(L.COD_ED) AS LIBRI_PUBBLICATI
									FROM EDITORE E,LIBRO L
									WHERE E.CODICE=L.COD_ED
									GROUP BY L.COD_ED
									ORDER BY LIBRI_PUBBLICATI DESC) AS T)
ORDER BY LIBRI_PUBBLICATI DESC;


"NOME LIBRO E TROVA DIPARTIMENTI IN CUI E' PRESENTE'"

//LEFT JOIN PER EMULARE IL MENO
SELECT * FROM(SELECT ISBN,NUMERO_COPIA, NOME_DIP
FROM COPIA) X
LEFT JOIN
 (
SELECT P.ISBN,P.NUMERO_COPIA
FROM PRESTITO P
)  T
	ON X.ISBN = T.ISBN AND X.NUMERO_COPIA=T.NUMERO_COPIA
	WHERE
	T.ISBN IS NULL AND T.NUMERO_COPIA IS NULL;




SELECT  C.NOME_DIP, COUNT(C.NUMERO_COPIA)
FROM (SELECT * FROM(SELECT ISBN,NUMERO_COPIA, NOME_DIP
FROM COPIA) X
LEFT JOIN
 (
SELECT P.ISBN,P.NUMERO_COPIA
FROM PRESTITO P
)  T
	ON X.ISBN = T.ISBN AND X.NUMERO_COPIA=T.NUMERO_COPIA
	WHERE
	T.ISBN IS NULL AND T.NUMERO_COPIA IS NULL), LIBRO L
WHERE C.ISBN = L.ISBN AND L.TITOLO LIKE '$titolo%'
GROUP BY  L.TITOLO, C.NOME_DIP;
